{% extends 'gorod/layout.html' %}

{% load staticfiles %}

{% block meta_title %}{{ city.title }} - события дня{% endblock %}

{% block meta_description %}{{ city.title }} - события дня{% endblock %}

{% block meta_additional %}<meta name="viewport" content="width=device-width" />{% endblock %}

{% block content %}
    <div class="b-feed">
        <ul class="b-feed__list">
            <div class="grid-sizer"></div>
            <div class="gutter-sizer"></div>

            {% for article in articles %}

                {# photo without picture not working #}
                {% if article.rubric.name != "photo" or article.picture %}
                    <li class="b-feed-item  b-feed-item_{{article.rubric}}" >
                
                        {# not photo img #}
                        {% if article.picture and article.rubric.name != "photo" %}
                            <img class="b-feed-item__picture" src="{{article.picture.url}}" />
                        {% endif %} 
                        
                        {# rubric #}
                        <span class="b-feed-item__rubrik">{{ article.rubric.title }}</span>
                        
                        {# photo author #}
                        {% if article.picture and article.rubric.name == "photo"%}
                            <span class="b-feed-item__author">{{ article.user }}</span>
                        {% endif %} 


                        {# not photo title #}
                        {% if article.rubric.name != "photo" %}
                            <h2 class="b-feed-item__title">
                                <a href="{% url 'gorod:article' article.id %}">{{ article.title }}</a>
                            </h2> 
                        {% endif %}         

                        {# photo img #}    
                        {% if article.picture and article.rubric.name == "photo"%}
                            <img class="b-feed-item__picture" src="{{article.picture.url}}" />
                        {% endif %}           
                        

                        {# not photo text #} 
                        {% if article.text and article.rubric.name != "photo"%}  
                            <p class="b-feed-item__text">
                                {% autoescape off %}
                                {{ article.text|striptags|truncatechars:255 }} 
                                {% endautoescape %}
                            </p>
                        {% endif %} 
                     
                    </li>
                {% endif %}
            {% endfor %}
        </ul>
    </div>

{% endblock %}

