{% extends 'gorod/layout.html' %}

{% load staticfiles %}
{% load thumbnail %}

{% block meta_title %}{{ city.title }} — события города{% endblock %}

{% block meta_description %}Новости {{ city.title }}, каталог организаций, полезная информация{% endblock %}


{% block content %}
    <div class="b-feed">
        <ul class="b-feed__list">
            <div class="grid-sizer"></div>
            <div class="gutter-sizer"></div>

            {% for article in articles %}

                {# photo without picture not working #}
                <li class="b-feed-item  b-feed-item_{{article.rubric}}" >
            
                    {# rubric #}
                    <a class="b-feed-item__rubrik" href="{% url 'gorod:feed-rubric' city.name article.rubric.name %}">
                        {{ article.rubric.title }}
                    </a>
                    
                    <a class="b-feed-item__link" href="{% url 'gorod:article' city.name article.id %}">
                        {# title photo #}
                        {% if article.rubric.name == "photo" %}
                            <h2 class="b-feed-item__title">{{ article.title }}</h2> 
                        {% endif %}

                        {#  img #}    
                        {% if article.picture %}
                            <img class="b-feed-item__picture" src="{{ article.picture|thumbnail_url:'feed_image' }}" />
                        {% endif %} 

                        {# title not photo #}
                        {% if article.rubric.name != "photo" %}
                            <h2 class="b-feed-item__title">{{ article.title }}</h2> 
                        {% endif %} 

                        {# not photo text #} 
                        {% if article.text and article.rubric.name != "photo"%}  
                            <p class="b-feed-item__text">
                                {% autoescape off %}
                                {{ article.text|striptags|truncatechars:255 }} 
                                {% endautoescape %}
                            </p>
                        {% endif %} 
                    </a>
                </li>
            {% endfor %}
        </ul>
        
    </div>


{% endblock %}

